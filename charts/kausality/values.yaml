# Default values for kausality

replicaCount: 1

image:
  repository: ghcr.io/kausality-io/kausality
  pullPolicy: IfNotPresent
  tag: ""  # Defaults to appVersion

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  seccompProfile:
    type: RuntimeDefault

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true

service:
  type: ClusterIP
  port: 443

resources:
  limits:
    cpu: 500m
    memory: 128Mi
  requests:
    cpu: 10m
    memory: 64Mi

nodeSelector: {}

tolerations: []

affinity: {}

# Webhook configuration
webhook:
  # Port the webhook server listens on
  port: 9443
  # Health probe bind address
  healthProbeBindAddress: ":8081"

# Certificate configuration
# cert-manager or self-signed certificates
certificates:
  # Use cert-manager to manage certificates
  certManager:
    enabled: false
    issuerRef:
      name: ""
      kind: Issuer  # or ClusterIssuer
  # Use self-signed certificates (generated by Helm)
  selfSigned:
    enabled: true

# Resource rules for webhook - which resources to intercept
resourceRules:
  include:
    # Example: intercept all apps/v1 resources
    # - apiGroups: ["apps"]
    #   resources: ["*"]
    # Example: intercept specific custom resources
    # - apiGroups: ["example.com"]
    #   resources: ["ekscluster", "nodepools"]
    []
  exclude:
    # Example: exclude ConfigMaps and Secrets
    # - apiGroups: [""]
    #   resources: ["configmaps", "secrets"]
    []

# Namespaces to exclude from drift detection
excludeNamespaces:
  - kube-system
  - kube-public
  - kube-node-lease

# Drift detection mode configuration
# Can be configured globally or per-resource
driftDetection:
  # Global default mode: "log" (allow but warn) or "enforce" (deny unapproved drift)
  defaultMode: log

  # Per-resource overrides (optional)
  # Allows different modes for different API groups/resources
  # overrides:
  #   - apiGroups: ["apps"]
  #     resources: ["deployments"]
  #     mode: enforce
  #   - apiGroups: ["example.com"]
  #     resources: ["ekscluster"]
  #     mode: enforce
  #   - apiGroups: [""]
  #     resources: ["configmaps"]
  #     mode: log  # Just log, don't enforce
  overrides: []

# Logging configuration
logging:
  # Log level (debug, info, warn, error)
  level: info
  # Development mode (more verbose)
  development: false
